/* Class names are defined in shared/config.js (D2LConfig.CSS). Keep in sync. */

/*
 * D2L Brightspace Dark Mode — Universal Filter Approach
 * Applies filter: invert(1) hue-rotate(180deg) on <html> in the top frame.
 * Counter-inverts media elements so images/video appear normal.
 */

/* ============================================================
   TOP-FRAME FILTER
   Applied only to the top-level frame via JS class.
   Sub-frames inherit the inversion from the parent compositing,
   so they must NOT apply the filter again.
   ============================================================ */
html.d2l-dark-mode-top {
  filter: invert(1) hue-rotate(180deg);
  background-color: white !important;
  color: black !important;
}

/* ============================================================
   TOP LAYER  (effective-root frames only)
   Popovers, modal dialogs, and fullscreen elements live in the
   browser's top layer, outside the html filter's reach.
   Apply the inversion directly on these elements.

   IMPORTANT: use d2l-dark-mode-top, NOT d2l-dark-mode-active.
   In child frames the visual inversion comes from the parent's
   compositing, which DOES affect top-layer elements. Adding
   another inversion there would counter-invert them back to
   light mode (invisible text).
   ============================================================ */
html.d2l-dark-mode-top :popover-open,
html.d2l-dark-mode-top dialog:modal,
html.d2l-dark-mode-top :fullscreen {
  filter: invert(1) hue-rotate(180deg) !important;
}

/* Counter-invert media inside top-layer elements */
html.d2l-dark-mode-top :popover-open :is(img, canvas, picture),
html.d2l-dark-mode-top dialog:modal :is(img, canvas, picture) {
  filter: invert(1) hue-rotate(180deg) !important;
}

/* Counter-invert video inside top-layer ONLY when video dark mode is off */
html.d2l-dark-mode-top:not(.d2l-video-dark) :popover-open video,
html.d2l-dark-mode-top:not(.d2l-video-dark) dialog:modal video {
  filter: invert(1) hue-rotate(180deg) !important;
}


/* ============================================================
   BASELINE FOR ALL DARK-MODE FRAMES
   Explicit white background ensures the canvas (browser default
   bg) stays white before the top-frame filter inverts it to
   black. Without this, some frames may have transparent or
   mismatched canvas backgrounds.

   Note: color-scheme: dark is intentionally NOT used here.
   While it darkens scrollbars and form controls natively, it
   also changes CSS system colors (Canvas → dark, CanvasText →
   white) which causes invisible-text bugs in child frames
   where D2L components rely on default/inherited colors.
   The inversion filter already makes the page look dark;
   scrollbars are styled explicitly below.
   ============================================================ */
html.d2l-dark-mode-active {
  color-scheme: dark;
  background-color: white !important;
  color: black !important;
}

/* ============================================================
   COUNTER-INVERT MEDIA (LIGHT DOM)
   Images, videos, canvas, and picture elements need
   double-inversion to appear in their original colors.
   Inline SVGs are excluded — they are typically D2L icons
   and should remain inverted (appearing as light-on-dark).
   ============================================================ */
html.d2l-dark-mode-active img:not(svg img),
html.d2l-dark-mode-active canvas,
html.d2l-dark-mode-active picture {
  filter: invert(1) hue-rotate(180deg) !important;
}

/* Counter-invert video ONLY when video dark mode is off */
html.d2l-dark-mode-active:not(.d2l-video-dark) video {
  filter: invert(1) hue-rotate(180deg) !important;
}

/* ============================================================
   DOCUMENT DARK MODE
   When document dark mode is active in a document viewer iframe,
   don't counter-invert the canvas — let the page-level
   filter invert the document content (white → dark, black → light).
   ============================================================ */
html.d2l-doc-dark canvas {
  filter: none !important;
}

/* ============================================================
   SCROLLBAR STYLING (Webkit)
   ============================================================ */
html.d2l-dark-mode-active ::-webkit-scrollbar {
  width: 10px;
  height: 10px;
}

html.d2l-dark-mode-active ::-webkit-scrollbar-track {
  background: #1a1a1a;
}

html.d2l-dark-mode-active ::-webkit-scrollbar-thumb {
  background: #555555;
  border-radius: 5px;
}

html.d2l-dark-mode-active ::-webkit-scrollbar-thumb:hover {
  background: #777777;
}